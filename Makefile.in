SUBDIRS = lib
OBJS = spec.o
PROGS = build

WARNINGS = -Wall -Wpointer-arith -Wstrict-prototypes -Wmissing-prototypes 
DEBUG = -g
OPTS = 
CFLAGS = $(WARNINGS) $(DEBUG) $(OPTS) -Ilib
LDFLAGS = $(DEBUG) -Llib
LOADLIBES = -lrpm
EFENCE = #-lefence

all: make-subdirs $(OBJS) $(PROGS)
	
make-subdirs:
	for d in $(SUBDIRS); do \
		(cd $$d; $(MAKE) CFLAGS="$(CFLAGS)" OPTS="$(OPTS)" \
		 WARNINGS="$(WARNINGS)" EFENCE=$(EFENCE)) ;\
	done

build: build.o spec.o

clean:
	for d in $(SUBDIRS); do \
		(cd $$d; $(MAKE) $@) ;\
	done
	rm -f *.o *~ $(PROGS)
