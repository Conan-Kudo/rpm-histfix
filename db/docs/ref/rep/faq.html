<!--Id: faq.so,v 1.1 2001/10/13 19:56:23 bostic Exp -->
<!--Copyright 1997-2001 by Sleepycat Software, Inc.-->
<!--All rights reserved.-->
<html>
<head>
<title>Berkeley DB Reference Guide: Replication FAQ</title>
<meta name="description" content="Berkeley DB: An embedded database programmatic toolkit.">
<meta name="keywords" content="embedded,database,programmatic,toolkit,b+tree,btree,hash,hashing,transaction,transactions,locking,logging,access method,access methods,java,C,C++">
</head>
<body bgcolor=white>
<table width="100%"><tr valign=top>
<td><h3><dl><dt>Berkeley DB Reference Guide:<dd>Berkeley DB Replication</dl></h3></td>
<td align=right><a href="../../ref/rep/trans.html"><img src="../../images/prev.gif" alt="Prev"></a><a href="../../reftoc.html"><img src="../../images/ref.gif" alt="Ref"></a><a href="../../ref/xa/intro.html"><img src="../../images/next.gif" alt="Next"></a>
</td></tr></table>
<p>
<h1 align=center>Replication FAQ</h1>
<p><ol>
<p><li><b>Does Berkeley DB provide support for sending database update messages
from the client application to the master?</b>
<p>No, it does not.  The Berkeley DB RPC server code could be modified to support
this functionality, but in general this protocol is left entirely to
the application.  Note, there is no reason not to use the communications
channels the application establishes for replication support to forward
database update messages to the master, Berkeley DB does not require that
those channels be used exclusively for replication messages.
<p><li><b>Can I use replication to partition my environment across
multiple sites?</b>
<p>No, this is not possible.  All replicated databases must be equally
shared by all environments in the replication group.
<p><li><b>What happens if an environment with out-of-date information
wins the election?</b>
<p>This is unlikely, but it is possible, and the outcome can be the loss
of information.  For example, consider a system with a master
environment and two clients A and B, where client A may upgrade to
master status and client B cannot.  Then, assume client A is partitioned
from the other two database environments, and it becomes out-of-date
with respect to the master.  Then, assume the master crashes and does
not come back on-line.  Subsequently, the network partition is restored,
and clients A and B hold an election.  As client B cannot win the
election, client A will win by default, and in order to get back into
sync with client B, it will unroll possibly committed transactions on
client B until they can once again move forward together.
<p>This scenario stresses the importance of good network infrastructure in
your replicated environments.  When replicating database environments
over sufficiently lossy networking, the best solution is usually to pick
a single master, and only hold elections when human intervention has
determined the selected master is unable to recover.
<p><li><b>How can I distinguish Berkeley DB messages from application messages?</b>
<p>There is no way to distinguish Berkeley DB messages from application-specific
messages, nor does Berkeley DB offer any way to wrap application messages
inside of Berkeley DB messages.  Distributed applications exchanging their
own messages should either enclose Berkeley DB messages in their own wrappers,
or use separate network connections to send and receive Berkeley DB messages.
The one exception to this rule is connection information for new sites;
Berkeley DB offers a simple method for sites joining replication groups to
send connection information to the other database environments in the
group (see <a href="../../ref/rep/newsite.html">Connecting to a new site</a>
for more information).
<p><li><b>How should I build my <b>send</b> function?</b>
<p>This depends on the specifics of the application.  One common way is
to write the <b>rec</b> and <b>control</b> arguments' sizes and data
to a socket connected to each remote site.
<p><li><b>Can I use replication to replicate just the database
environment's log files?</b>
<p>Not explicitly.  However, a client replica will contain a full set of
logs as generated by the master, within the semantic limits of the
transport mechanism.  In the event that a master crashes, the client
environment may be used directly (after running recovery) or for
catastrophic recovery on the master site.
<p><font color=red>There's a DB_REP_LOGSONLY flag -- so this is wrong, I
think.</font>
</ol>
<table width="100%"><tr><td><br></td><td align=right><a href="../../ref/rep/trans.html"><img src="../../images/prev.gif" alt="Prev"></a><a href="../../reftoc.html"><img src="../../images/ref.gif" alt="Ref"></a><a href="../../ref/xa/intro.html"><img src="../../images/next.gif" alt="Next"></a>
</td></tr></table>
<p><font size=1><a href="http://www.sleepycat.com">Copyright Sleepycat Software</a></font>
</body>
</html>
